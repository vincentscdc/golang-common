<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# handlerwrap

```go
import "github.com/monacohq/golang-common/transport/http/handlerwrap/v3"
```

This package allows you to wrap your API to save you from boilerplate code

<details><summary>Example (Get)</summary>
<p>

Wrapping a GET http handler\.

```go
{
	zl := zerolog.New(io.Discard).With()

	getter := func(ctx context.Context, key string) (string, *ErrorResponse) {
		if key == "id" {
			return "1", nil
		}

		return "", MissingParamError{Name: key}.ToErrorResponse()
	}

	getHandler := func(nupg NamedURLParamsGetter) TypedHandler {
		return func(r *http.Request) (*Response, *ErrorResponse) {
			idParam, errR := nupg(r.Context(), "id")
			if errR != nil {
				return nil, errR
			}

			id, err := strconv.ParseInt(idParam, 10, 64)
			if err != nil {
				return nil, ParsingParamError{
					Name:  "id",
					Value: idParam,
				}.ToErrorResponse()
			}

			return &Response{
				Body:       id,
				Headers:    make(map[string]string),
				StatusCode: http.StatusOK,
			}, nil
		}
	}

	logger := zl.Logger()

	Wrapper(&logger, getHandler(getter)).ServeHTTP(nil, nil)
}
```

</p>
</details>

<details><summary>Example (Ok Style)</summary>
<p>

Using the okStyle wrapper

```go
{
	zl := zerolog.New(io.Discard).With()

	getter := func(r *http.Request) (*Response, *ErrorResponse) {
		return &Response{
			Body: map[string]any{
				"hello": "world",
			},
			Headers:    make(map[string]string),
			StatusCode: http.StatusOK,
		}, nil
	}

	logger := zl.Logger()

	Wrapper(&logger, OKStyle("data", getter))
}
```

</p>
</details>

<details><summary>Example (Post)</summary>
<p>

Wrapping a POST http handler\.

```go
{
	zl := zerolog.New(io.Discard).With()

	type postRequest struct {
		Name string `json:"name"`
	}

	createHandler := func() TypedHandler {
		return func(r *http.Request) (*Response, *ErrorResponse) {
			var pr postRequest

			if err := BindBody(r, &pr); err != nil {
				return nil, err
			}

			log.Println(pr)

			return &Response{
				Body:       pr,
				Headers:    make(map[string]string),
				StatusCode: http.StatusCreated,
			}, nil
		}
	}

	logger := zl.Logger()

	Wrapper(&logger, createHandler()).ServeHTTP(nil, nil)
}
```

</p>
</details>

## Index

- [Constants](<#constants>)
- [func Wrapper(log *zerolog.Logger, f TypedHandler) http.HandlerFunc](<#func-wrapper>)
- [type ErrorResponse](<#type-errorresponse>)
  - [func BindBody(r *http.Request, target interface{}) *ErrorResponse](<#func-bindbody>)
  - [func NewErrorResponse(err error, headers map[string]string, statusCode int, errCode string, msg string) *ErrorResponse](<#func-newerrorresponse>)
  - [func NewErrorResponseFromCryptoUserUUIDError(err error) *ErrorResponse](<#func-newerrorresponsefromcryptouseruuiderror>)
  - [func NewUserErrorResponse(err error, headers map[string]string, statusCode int, errCode string, msg string, titleKey string, msgKey string) *ErrorResponse](<#func-newusererrorresponse>)
  - [func (her *ErrorResponse) AddHeaders(headers map[string]string)](<#func-errorresponse-addheaders>)
  - [func (her *ErrorResponse) IsEqual(errR1 *ErrorResponse) bool](<#func-errorresponse-isequal>)
- [type InternalServerError](<#type-internalservererror>)
  - [func (e InternalServerError) Error() string](<#func-internalservererror-error>)
  - [func (e InternalServerError) ToErrorResponse() *ErrorResponse](<#func-internalservererror-toerrorresponse>)
- [type L10NError](<#type-l10nerror>)
- [type MissingParamError](<#type-missingparamerror>)
  - [func (e MissingParamError) Error() string](<#func-missingparamerror-error>)
  - [func (e MissingParamError) ToErrorResponse() *ErrorResponse](<#func-missingparamerror-toerrorresponse>)
- [type NamedURLParamsGetter](<#type-namedurlparamsgetter>)
- [type NotFoundError](<#type-notfounderror>)
  - [func (e NotFoundError) Error() string](<#func-notfounderror-error>)
  - [func (e NotFoundError) ToErrorResponse() *ErrorResponse](<#func-notfounderror-toerrorresponse>)
- [type ParsingParamError](<#type-parsingparamerror>)
  - [func (e ParsingParamError) Error() string](<#func-parsingparamerror-error>)
  - [func (e ParsingParamError) ToErrorResponse() *ErrorResponse](<#func-parsingparamerror-toerrorresponse>)
- [type Response](<#type-response>)
- [type TypedHandler](<#type-typedhandler>)
  - [func OKStyle(bodyName string, handler TypedHandler) TypedHandler](<#func-okstyle>)


## Constants

```go
const (
    // ErrCodeParsingBody is the error code returned to the user when there is an error parsing
    // the body of the request.
    ErrCodeParsingBody = "error_parsing_body"
)
```

## func [Wrapper](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/wrapper.go#L15-L18>)

```go
func Wrapper(log *zerolog.Logger, f TypedHandler) http.HandlerFunc
```

Wrapper will actually do the boring work of logging an error and render the response\.

## type [ErrorResponse](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L14-L21>)

ErrorResponse is a wrapper for the error response body to have a clean way of displaying errors\.

```go
type ErrorResponse struct {
    Err          error             `json:"-"`
    Headers      map[string]string `json:"-"`
    StatusCode   int               `json:"-"`
    Error        string            `json:"error"`
    ErrorMessage string            `json:"error_message"`
    L10NError    *L10NError        `json:"l10n_error,omitempty"`
}
```

### func [BindBody](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/body.go#L16>)

```go
func BindBody(r *http.Request, target interface{}) *ErrorResponse
```

BindBody will bind the body of the request to the given interface\.

### func [NewErrorResponse](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L30-L36>)

```go
func NewErrorResponse(err error, headers map[string]string, statusCode int, errCode string, msg string) *ErrorResponse
```

NewErrorResponse creates a new ErrorResponse\.

### func [NewErrorResponseFromCryptoUserUUIDError](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L138>)

```go
func NewErrorResponseFromCryptoUserUUIDError(err error) *ErrorResponse
```

### func [NewUserErrorResponse](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L47-L55>)

```go
func NewUserErrorResponse(err error, headers map[string]string, statusCode int, errCode string, msg string, titleKey string, msgKey string) *ErrorResponse
```

NewUserErrorResponse create a new ErrorResponse with L10NError

### func \(\*ErrorResponse\) [AddHeaders](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L71>)

```go
func (her *ErrorResponse) AddHeaders(headers map[string]string)
```

AddHeaders add the headers to the error response it will overwrite a header if it already present\, but will leave others in place

### func \(\*ErrorResponse\) [IsEqual](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L88>)

```go
func (her *ErrorResponse) IsEqual(errR1 *ErrorResponse) bool
```

IsEqual checks if an error response is equal to another\.

## type [InternalServerError](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L113-L115>)

InternalServerError is an error that is returned when an internal server error occurs\.

```go
type InternalServerError struct {
    Err error
}
```

### func \(InternalServerError\) [Error](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L117>)

```go
func (e InternalServerError) Error() string
```

### func \(InternalServerError\) [ToErrorResponse](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L121>)

```go
func (e InternalServerError) ToErrorResponse() *ErrorResponse
```

## type [L10NError](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L24-L27>)

L10NError is an error for localization

```go
type L10NError struct {
    TitleKey   string `json:"title_key"`
    MessageKey string `json:"message_key"`
}
```

## type [MissingParamError](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/url_params.go#L13-L15>)

MissingParamError is the error that is returned when a named URL param is missing\.

```go
type MissingParamError struct {
    Name string
}
```

### func \(MissingParamError\) [Error](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/url_params.go#L17>)

```go
func (e MissingParamError) Error() string
```

### func \(MissingParamError\) [ToErrorResponse](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/url_params.go#L21>)

```go
func (e MissingParamError) ToErrorResponse() *ErrorResponse
```

## type [NamedURLParamsGetter](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/url_params.go#L10>)

NamedURLParamsGetter is the interface that is used to parse the URL parameters\.

```go
type NamedURLParamsGetter func(ctx context.Context, key string) (string, *ErrorResponse)
```

## type [NotFoundError](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L126-L128>)

NotFoundError is an error that is returned when a resource is not found\.

```go
type NotFoundError struct {
    Designation string
}
```

### func \(NotFoundError\) [Error](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L130>)

```go
func (e NotFoundError) Error() string
```

### func \(NotFoundError\) [ToErrorResponse](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/error_response.go#L134>)

```go
func (e NotFoundError) ToErrorResponse() *ErrorResponse
```

## type [ParsingParamError](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/url_params.go#L31-L34>)

ParsingParamError is the error that is returned when a named URL param is invalid\.

```go
type ParsingParamError struct {
    Name  string
    Value string
}
```

### func \(ParsingParamError\) [Error](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/url_params.go#L36>)

```go
func (e ParsingParamError) Error() string
```

### func \(ParsingParamError\) [ToErrorResponse](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/url_params.go#L40>)

```go
func (e ParsingParamError) ToErrorResponse() *ErrorResponse
```

## type [Response](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/response.go#L10-L14>)

Response is a wrapper for the response body\.

```go
type Response struct {
    Headers    map[string]string
    Body       any
    StatusCode int
}
```

## type [TypedHandler](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/wrapper.go#L12>)

TypedHandler is the handler that you are actually handling the response\.

```go
type TypedHandler func(r *http.Request) (*Response, *ErrorResponse)
```

### func [OKStyle](<https://github.com/monacohq/golang-common/blob/main/transport/http/handlerwrap/okstyle.go#L25>)

```go
func OKStyle(bodyName string, handler TypedHandler) TypedHandler
```

OKStyle wraps an ok styled response that uses a special boolean field \`ok\` to indicate whether the request has been successfully responded or not\. Specifically\, On success\, the response body will be transformed to \`\`\`json \{ "ok": true\, \<OTHER BODY PROPERTIES\> \} \`\`\`

On failure\, the response body will be \`\`\`json \{ "ok": false\, "error\_code": \<ERROR CODE FROM APPLICATION\> "error\_message": \<ERROR MESSAGE FROM APPLICATION\> \} \`\`\`



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
